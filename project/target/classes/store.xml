<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace xml을 구별하기 위한 이름 -->
<!-- resultMap는 table에 컬럼명과 class에 dept변수명이 다를 때 mapping하는 용도 -->
<mapper namespace="storens">
<resultMap type="store" id="storeResult">
		<result column="s_num" property="s_num"/>
		<result column="s_del" property="s_del"/>
		<result column="s_Pclass" property="s_Pclass"/>
		<result column="s_Pname" property="s_Pname"/>
		<result column="s_Pconfig" property="s_Pconfig"/>
		<result column="s_Pimage" property="s_Pimage"/>
		<result column="s_purchase" property="s_purchase"/>
		<result column="s_prive" property="s_prive"/>		
		<result column="del" property="del"/>	
							
		<result column="s_per" property="s_per"/>	
		<result column="s_pernd" property="s_pernd"/>	
		<result column="s_total" property="s_total"/>
		<result column="s_sale" property="s_sale"/>
		
	</resultMap>
	

	
	
	<select id="list" resultMap="storeResult">
	select * from store order by s_num
	</select>	
	
	<select id="select" parameterType="integer" resultType="store"> 
	select * from store where s_num=#{s_num}
	</select>
			
	<select id="pclist" parameterType="integer" resultMap="storeResult" >
	select * from store where s_Pclass=#{s_Pclass} order by s_num
	</select>

	<insert id="insert" parameterType="store">
	insert into store values (s_num.nextval , 'n', #{s_Pclass}, #{s_Pname}, 
	#{s_Pconfig}, #{s_Pimage}, #{s_purchase}, #{s_prive}, 'n',
	#{s_per},#{s_pernd},#{s_total},#{s_sale}
	)
	</insert>
	
	<update id="delete" parameterType="integer">
	 update store set s_del='y' where s_num=#{s_num}
	</update>
<!-- 	
	<delete id="delete" parameterType="integer">	 
	 delete from store where s_num=#{s_num}
	</delete> -->
	
	<update id="update" parameterType="store">
	 update store set 
	 s_del=#{s_del}, s_Pclass=#{s_Pclass}, s_Pname=#{s_Pname}, 
	 s_Pconfig=#{s_Pconfig}
	<if test="s_Pimage!=null">
			,  s_Pimage=#{s_Pimage}
	</if>
	 ,s_purchase=#{s_purchase},s_prive=#{s_prive},del=#{del},
	 s_per=#{s_per}, s_pernd=#{s_pernd},s_total=#{s_total},s_sale=#{s_sale} 
	 where s_num=#{s_num} 
	</update>

<!-- ================================= -->
	<update id="resurrection" parameterType="integer">
	 update store set s_del='n' where s_num=#{s_num}
	</update>
	
	<update id="counts" parameterType="integer">
	 update store 
	 set s_total=#{s_total-s_purchase}
	 where s_num=#{s_num}
	</update>
<!--  from ord o, store s  -->

</mapper>
