<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace xml을 구별하기 위한 이름 -->
<!-- resultMap는 table에 컬럼명과 class에 dept변수명이 다를 때 mapping하는 용도 -->
<mapper namespace="moviens">
	<resultMap type="movie" id="movieResult">
		<result column="m_num" property="m_num"/>
		<result column="m_title" property="m_title"/>
		<result column="m_content" property="m_content"/>
		<result column="m_rank" property="m_rank"/>
		<result column="m_opendate" property="m_opendate"/>
		<result column="m_state" property="m_state"/>
		<result column="m_time" property="m_time"/>
		<result column="m_grade" property="m_grade"/>
		<result column="m_poster" property="m_poster"/>
		<result column="m_director" property="m_director"/>
		<result column="m_actor" property="m_actor"/>
		<result column="m_genre" property="m_genre"/>
		<result column="m_del" property="m_del"/>
	</resultMap>
	<select id="list" resultMap="movieResult">
		select * from movie order by m_opendate
	</select>
	<select id="select" parameterType="integer" resultType="movie">
		select * from movie where m_num=#{m_num}
	</select>
	<insert id="insert" parameterType="movie">
		insert into movie values (#{m_num}, #{m_title}, #{m_director}, #{m_actor},
			#{m_content}, #{m_rank}, #{m_opendate}, #{m_state}, 
			#{m_time}, #{m_genre}, 0, #{m_poster}, #{m_stillcut})
	</insert>
	<select id="selectTitle" parameterType="string" resultType="movie">
		select * from movie where m_title=#{m_title}
	</select>
	<update id="update" parameterType="movie">
		update movie set m_title=#{m_title}, m_director=#{m_director}, m_actor=#{m_actor},
			m_content=#{m_content}, m_rank=#{m_rank}, m_opendate=#{m_opendate}, 
			m_state=#{m_state}, m_time=#{m_time}, m_genre=#{m_genre}
			<if test="m_poster != null">
				, m_poster=#{m_poster} 
			</if>
			where m_num=#{m_num}
	</update>
	<insert id="insertPh" parameterType="stillcut">
		insert into stillcut values (sc_num.nextval, #{m_num}, #{m_stillcut})
	</insert>
	<!-- <insert id="insertPh" parameterType="java.util.List">
		insert all
		<foreach collection="list" item="item">
			into stillcut (sc_num, m_num, m_stillcut) 
				values (sc_num.nextval, #{item.m_num}, #{item.m_stillcut})
		</foreach>
	</insert> -->
	<select id="listPhoto" parameterType="string" resultType="stillcut">
		select * from stillcut where m_num=#{m_num} order by sc_num
	</select>
</mapper>