<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace xml을 구별하기 위한 이름 -->
<!-- resultMap는 table에 컬럼명과 class에 dept변수명이 다를 때 mapping하는 용도 -->
<mapper namespace="theaterns">
	<resultMap type="movieTheater" id="movieTheaterResult">
		<result property="mt_num"    column="mt_num"/>
		<result property="mt_name"    column="mt_name"/>
		<result property="mt_count" 	    column="mt_count"/>
		<result property="t_num"      column="t_num"/>
		<!-- 조인용으로 부서 전체 정보 -->
		<collection property="theater" resultMap="theaterResult"></collection>
	</resultMap>
	<resultMap type="theater" id="theaterResult">
		<result property="t_num"    column="t_num"/>
		<result property="t_title"    column="t_title"/>
		<result property="t_loc" 	    column="t_loc"/>
		<result property="t_addr"      column="t_addr"/>
		<result property="t_number"  column="t_number"/>
		<result property="t_gui" column="t_gui"/>
	</resultMap>
	<select id="locList" parameterType="theater" resultType="theater">
		select distinct t_loc from theater order by t_loc
		<!-- select distinct t_loc, (select count(*) from theater where t_loc = #{t_loc}) as t_total from theater order by t_loc -->
	</select>
	<select id="selectTheater" parameterType="string" resultType="theater">
		select * from theater where t_loc=#{id} 
	</select>
	<select id="selectTitle" parameterType="string" resultType="theater">
		select * from theater where t_title =#{t_title}
	</select>
	<select id="list" resultType="theater">
		select * from theater order by t_num
	</select>
	<select id="listT_loc" resultType="theater">
		select distinct t_loc from theater order by t_loc
	</select>
	<insert id="insert" parameterType="theater">
		insert into theater values (theater_t_num_seq.nextval, #{t_title}, #{t_loc}, #{t_addr}, 
			#{t_number}, #{t_gui})
	</insert>
	<select id="select" parameterType="hashmap" resultType="theater">
		select * from theater where t_loc=#{t_loc} and t_title=#{t_title}
	</select>
	<select id="titleList" resultType="string">
		select distinct t_loc from theater
	</select>
	<select id="movieTheaterList" resultType="movieTheater">
		select * from movieTheater order by mt_num
	</select>
	<insert id="numInsert" parameterType="hashmap">
		insert into movieTheater values(mt_num.nextval, #{mt_name}, #{mt_count}, #{t_num})
	</insert>
	<select id="locList2" parameterType="string" resultMap="movieTheaterResult">
		select m.*, t.* from theater t, movieTheater m 
			where m.t_num=t.t_num and t.t_loc = #{t_loc}
			order by t_title
	</select>
</mapper>